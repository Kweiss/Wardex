# Glossary

Terms used throughout the Wardex documentation.

---

### Adaptive Tiers
Wardex's system for automatically scaling security posture based on the USD value at risk. Four tiers: Audit (< $1), Co-pilot ($1-$100), Guardian ($100-$10K), Fortress (> $10K). See [Security Tiers](./security/security-tiers.md).

### Allowlist
A list of trusted addresses, contracts, and protocol identifiers. Items on the allowlist receive a lower risk score but are still evaluated through the full pipeline.

### Approval (Token Approval)
An ERC-20 `approve(spender, amount)` call that grants a contract permission to spend tokens on your behalf. Infinite approvals (`type(uint256).max`) are a major attack vector — Wardex blocks them by default.

### Audit Entry
A record of a single security evaluation, including the transaction, verdict, risk scores, and reasons. Stored in the audit trail. See [Audit & Compliance](./security/audit-compliance.md).

### Audit Trail
The chronological record of all security evaluations performed by a Wardex instance. Retains the last 10,000 entries in memory. Can be exported via callbacks.

### Auto-Freeze
Automatic emergency halt triggered when 5 or more transactions are blocked within the last 10 evaluations. Indicates a possible active attack. Requires human intervention to resume.

### Behavioral Comparator
Middleware stage (#6) that compares a transaction against the agent's behavioral baseline. Detects anomalies in value, frequency, timing, and contract interaction patterns.

### Block (Decision)
A verdict where Wardex prevents a transaction from proceeding. The agent should not sign or submit the transaction.

### Caveat (Delegation)
A constraint attached to a MetaMask delegation. Each caveat specifies an enforcer contract and ABI-encoded terms that define the constraint (e.g., "only call these contracts" or "max 1 ETH per transaction").

### Caveat Enforcer
A smart contract in the MetaMask Delegation Framework that verifies a specific constraint on-chain. Examples: AllowedTargetsEnforcer, ValueLteEnforcer, TimestampEnforcer.

### Composite Score
The weighted combination of context, transaction, and behavioral risk scores, ranging from 0 (safe) to 100 (dangerous). Produced by the risk aggregator middleware.

### Context Analyzer
Middleware stage (#1) that scans conversation context for prompt injection patterns, jailbreak attempts, urgency manipulation, and cross-MCP attacks.

### Contract Checker
Middleware stage (#5) that analyzes contract bytecode for dangerous patterns: SELFDESTRUCT, DELEGATECALL, CALLCODE, proxy patterns, and honeypot indicators.

### Delegation (MetaMask)
An EIP-712 signed authorization that grants scoped authority from a delegator (owner) to a delegate (agent). Backed by on-chain enforcer contracts. See [Delegation Framework Guide](./guides/delegation-framework.md).

### DelegationManager
Wardex class that creates, validates, and manages MetaMask Delegation Framework delegations. Mirrors the SessionManager API.

### Denylist
A list of known-malicious addresses. Transactions to denylisted addresses are blocked at Guardian tier and above.

### EIP-712
Ethereum Improvement Proposal for typed structured data hashing and signing. Used by the MetaMask Delegation Framework for delegation signatures.

### ERC-4337 (Account Abstraction)
Standard for smart contract accounts that support programmable validation logic. Wardex's `WardexValidationModule` hooks into ERC-4337 to enforce on-chain spending limits.

### ERC-7715 (Session Keys)
Standard for scoped wallet permission systems. Session keys allow an agent to transact within boundaries (contracts, value limits, time) without the owner's full key.

### Evaluation
The process of passing a transaction through the Wardex middleware pipeline to produce a security verdict. Each evaluation generates an audit entry.

### Evaluation ID
A unique UUID assigned to every evaluation. Used for audit trail correlation and incident investigation.

### Fortress Tier
The highest security tier (> $10K). Always blocks transactions, requires human approval, enforces a 15-minute time-lock, and records on-chain proofs.

### Freeze (Decision)
A verdict where ALL operations are halted. Can be triggered automatically (auto-freeze) or manually (`wardex.freeze()`). Requires `wardex.unfreeze()` to resume.

### Guardian Tier
Security tier for $100-$10K transactions. Blocks transactions with composite risk score above 70. Notifies the operator.

### HMAC-SHA256 Approval Token
A cryptographic token generated by Wardex when a transaction is approved. The isolated signer verifies this token before signing. Prevents unauthorized signing.

### Honeypot Contract
A malicious contract designed to appear legitimate but contains hidden mechanisms (SELFDESTRUCT, fee extraction, approval traps) that steal funds.

### Infinite Approval
A token approval where the amount is `type(uint256).max` or close to it (>= 2^128). Grants unlimited spending permission to a contract — dangerous because a compromised contract can drain all tokens.

### Isolated Signer
A separate process (or TEE, or MPC network) that holds private key material. The AI agent communicates with it over Unix socket IPC but can never access the key directly.

### Key Isolation
The architectural principle that the AI model NEVER has access to private keys. Keys live in a separate process (SignerServer) and can only be used to sign transactions that have a valid Wardex approval token.

### MCP (Model Context Protocol)
Anthropic's protocol for connecting AI models to external tools. Wardex's MCP server exposes security evaluation as MCP tools.

### Middleware
An async function in the Wardex pipeline that receives a shared context and a `next()` function. Each middleware stage enriches the context with security findings. See [Custom Middleware](./guides/custom-middleware.md).

### Middleware Context
The shared state object passed through the pipeline. Contains the transaction, decoded data, risk scores, reasons, reputation data, and the active policy.

### Output Filter
A mandatory pipeline that scans all text output for sensitive data (private keys, seed phrases, mnemonics) and redacts them. Cannot be bypassed.

### Pipeline
The 9-stage middleware chain that every transaction passes through: contextAnalyzer, transactionDecoder, valueAssessor, addressChecker, contractChecker, behavioralComparator, [custom], riskAggregator, policyEngine.

### Policy Engine
Middleware stage (#9) that applies security tier rules to the accumulated risk scores and reasons to produce the final verdict.

### Prompt Injection
An attack where malicious instructions are embedded in content that an AI agent processes (tool outputs, conversation, web pages). Wardex's context analyzer detects 10+ injection patterns.

### Proof Hash
A cryptographic hash of an evaluation, included in Fortress-tier verdicts. Can be submitted on-chain for tamper-proof audit evidence.

### Risk Aggregator
Middleware stage (#8) that combines context, transaction, and behavioral risk scores into a weighted composite score (0-100).

### Risk Score
A numerical assessment (0-100) of threat level in three dimensions: context (prompt injection likelihood), transaction (on-chain threat signals), and behavioral (deviation from baseline). Higher = more dangerous.

### Security Reason
A specific finding from the evaluation pipeline. Contains a code (e.g., `PROMPT_INJECTION`), human-readable message, severity level, and source middleware.

### Security Verdict
The output of every Wardex evaluation. Contains the decision (approve/advise/block/freeze), risk scores, reasons, suggestions, and audit metadata.

### Session Key
A temporary, scoped cryptographic key that allows an agent to transact within boundaries. Managed by `SessionManager`. See [Session Keys Guide](./guides/session-keys.md).

### SessionManager
Wardex class that creates, validates, and manages ERC-7715 session keys with enforced boundaries (allowed contracts, value limits, daily volume, expiration).

### Shield
The main `WardexShield` object returned by `createWardex()`. Orchestrates the pipeline, maintains state, and provides the evaluation API.

### Smart Account
An ERC-4337 smart contract wallet that supports programmable transaction validation. Wardex's `WardexValidationModule` can be installed as a validation module.

### Strict Mode (Delegation)
A delegation option that adds an `AllowedMethodsEnforcer` to block `approve` and `setApprovalForAll` function selectors at the smart contract level, not just off-chain.

### Transaction Decoder
Middleware stage (#2) that decodes calldata into function names and parameters. Identifies approvals, transfers, and ETH value.

### Trust Level
A classification assigned to instruction sources: `high` (direct user), `medium` (known MCP server), `low` (unknown tool), `untrusted`. Lower trust levels increase risk scoring.

### Value Assessor
Middleware stage (#3) that estimates the USD value at risk and determines which security tier to apply.

### WardexValidationModule
A Solidity smart contract (ERC-4337 compatible) that enforces spending limits, approval token verification, and emergency freeze on-chain. Deployed via Foundry.
